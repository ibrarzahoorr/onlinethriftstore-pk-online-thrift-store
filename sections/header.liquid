<link rel="stylesheet" href="{{ 'component-list-menu.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-search.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-menu-drawer.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-cart-notification.css' | asset_url }}" media="print" onload="this.media='all'">

<style>
  :root {
    --header-bg: rgba(255, 255, 255, 0.95);
    --header-text: #000;
    --header-accent: #000;
    --font-family: 'Poppins', 'Helvetica Neue', Arial, sans-serif;
  }

  .header-wrapper {
    backdrop-filter: blur(14px);
    background: var(--header-bg);
    border-bottom: 1px solid rgba(0,0,0,0.05);
    transition: all 0.3s ease-in-out;
    font-family: var(--font-family);
    position: relative;
    z-index: 1000;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 1rem;
    color: var(--header-text);
  }

  /* Sticky shrink */
  .scrolled-past-header .header {
    padding: 8px 1rem !important;
  }
  .scrolled-past-header .header__heading-logo-wrapper {
    transform: scale(0.85);
    transition: transform 0.3s ease;
  }

  /* Desktop Nav */
  .main-nav { display: none; }
  @media(min-width: 991px) {
    .main-nav { display: block; }
    .list-menu {
      list-style: none;
      display: flex;
      gap: 2rem;
      margin: 0;
      padding: 0;
    }
    .list-menu__item--link {
      font-weight: 500;
      font-size: 1rem;
      text-decoration: none;
      color: var(--header-text);
      position: relative;
      transition: color 0.3s ease;
    }
    .list-menu__item--link:hover {
      color: var(--header-accent);
    }
    .list-menu__item--link::after {
      content: "";
      position: absolute;
      bottom: -6px;
      left: 0;
      height: 2px;
      width: 0%;
      background: var(--header-accent);
      transition: width 0.3s ease;
    }
    .list-menu__item--link:hover::after { width: 100%; }
  }

  /* Mobile Layout */
  .menu-toggle {
    display: flex;
    flex-direction: column;
    gap: 5px;
    cursor: pointer;
    width: 25px;
  }
  .menu-toggle span {
    height: 2px;
    background: var(--header-text);
    border-radius: 2px;
    transition: all 0.3s ease;
  }
  @media(min-width:991px){ .menu-toggle { display:none; } }

  .header__logo-mobile {
    flex: 1;
    text-align: center;
  }

  /* Drawer + Overlay */
  .drawer-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 9998;
  }
  .drawer-overlay.active {
    opacity: 1;
    visibility: visible;
  }
  .drawer {
    position: fixed;
    top: 0; left: -100%;
    width: 80%;
    height: 100%;
    background: #fff;
    padding: 2rem 1.5rem;
    transition: left 0.4s ease;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  .drawer.open { left: 0; }
  .drawer a {
    font-size: 1.1rem;
    text-decoration: none;
    color: #000;
    font-weight: 500;
    transition: color 0.3s ease;
  }
  .drawer a:hover { color: var(--header-accent); }
  .drawer-close {
    align-self: flex-end;
    font-size: 1.5rem;
    cursor: pointer;
  }

  /* Icons */
  .header__icons {
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }
  .header__icon {
    border-radius: 50%;
    padding: 0.5rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease, transform 0.2s ease;
  }
  .header__icon:hover {
    background: rgba(0,0,0,0.08);
    transform: scale(1.1);
  }

  /* Search expand */
  .header__icons .header-search input {
    width: 0;
    opacity: 0;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 0.4rem 0.6rem;
    transition: width 0.4s ease, opacity 0.3s ease;
  }
  .header__icons .header-search input:focus {
    width: 160px;
    opacity: 1;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function(){
    const toggle = document.querySelector(".menu-toggle");
    const drawer = document.querySelector(".drawer");
    const overlay = document.querySelector(".drawer-overlay");
    const closeBtn = document.querySelector(".drawer-close");

    function closeDrawer() {
      drawer.classList.remove("open");
      overlay.classList.remove("active");
    }
    toggle?.addEventListener("click", ()=>{
      drawer.classList.add("open");
      overlay.classList.add("active");
    });
    closeBtn?.addEventListener("click", closeDrawer);
    overlay?.addEventListener("click", closeDrawer);
  });
</script>

{% liquid
  assign header_tag = 'div'
  if section.settings.sticky_header_type != 'none'
    assign header_tag = 'sticky-header'
  endif
%}

<{{ header_tag }}
  {% if header_tag == 'sticky-header' %}
    data-sticky-type="{{ section.settings.sticky_header_type }}"
  {% endif %}
  class="header-wrapper color-{{ section.settings.color_scheme }}"
>
  <header class="header header--mobile-{{ section.settings.mobile_logo_position }}">
    
    <!-- Mobile Left: Menu -->
    <div class="menu-toggle">
      <span></span><span></span><span></span>
    </div>

    <!-- Logo Center -->
    <div class="header__logo-mobile">
      <a href="{{ routes.root_url }}">
        {% if settings.logo != blank %}
          {{ settings.logo | image_url: width: 180 | image_tag: class: 'header__heading-logo', alt: shop.name }}
        {% else %}
          <span class="h2">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>

    <!-- Icons Right -->
    <div class="header__icons">
      {% render 'header-search', input_id: 'Search-In-Modal' %}
      {% if shop.customer_accounts_enabled %}
        <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" class="header__icon">
          <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
        </a>
      {% endif %}
      <a href="{{ routes.cart_url }}" class="header__icon" id="cart-icon-bubble">
        <span class="svg-wrapper">
          {% if cart == empty %}
            {{ 'icon-cart-empty.svg' | inline_asset_content }}
          {% else %}
            {{ 'icon-cart.svg' | inline_asset_content }}
          {% endif %}
        </span>
        {% if cart != empty %}
          <div class="cart-count-bubble"><span>{{ cart.item_count }}</span></div>
        {% endif %}
      </a>
    </div>
  </header>

  <!-- Desktop Menu -->
  {% if section.settings.menu != blank %}
    <nav class="main-nav">
      <ul class="list-menu">
        {% for link in linklists[section.settings.menu].links %}
          <li><a href="{{ link.url }}" class="list-menu__item--link">{{ link.title }}</a></li>
        {% endfor %}
      </ul>
    </nav>
  {% endif %}

  <!-- Mobile Drawer -->
  <div class="drawer">
    <div class="drawer-close">âœ•</div>
    {% if section.settings.menu != blank %}
      {% for link in linklists[section.settings.menu].links %}
        <a href="{{ link.url }}">{{ link.title }}</a>
      {% endfor %}
    {% endif %}
  </div>
  <div class="drawer-overlay"></div>
</{{ header_tag }}>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "select",
      "id": "sticky_header_type",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "on-scroll-up", "label": "On Scroll Up" },
        { "value": "always", "label": "Always Sticky" },
        { "value": "reduce-logo-size", "label": "Shrink on Scroll" }
      ],
      "default": "on-scroll-up",
      "label": "Sticky header type"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "default": "scheme-1",
      "label": "Color scheme"
    }
  ]
}
{% endschema %}
