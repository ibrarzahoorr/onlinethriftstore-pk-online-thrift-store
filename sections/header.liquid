<link rel="stylesheet" href="{{ 'component-list-menu.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-search.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-menu-drawer.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-cart-notification.css' | asset_url }}" media="print" onload="this.media='all'">

{%- if settings.predictive_search_enabled -%}
  <link rel="stylesheet" href="{{ 'component-price.css' | asset_url }}" media="print" onload="this.media='all'">
{%- endif -%}

{%- if section.settings.menu_type_desktop == 'mega' -%}
  <link rel="stylesheet" href="{{ 'component-mega-menu.css' | asset_url }}" media="print" onload="this.media='all'">
{%- endif -%}

<style>
  /* --- Original Dawn header styles stay same --- */

  /* === Mobile Header Fix === */
  @media(max-width: 990px) {
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Make logo center */
    .header__heading {
      flex: 1;
      text-align: center;
    }
    .header__heading-link {
      display: inline-block;
    }

    /* Drawer trigger (hamburger) left */
    header-drawer {
      order: -1;
    }

    /* Icons on right */
    .header__icons {
      display: flex;
      gap: 0.8rem;
    }

    /* Drawer overlay */
    .menu-drawer__overlay {
      background: rgba(0,0,0,0.5);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
    }
    .menu-drawer[open] ~ .menu-drawer__overlay {
      opacity: 1;
      visibility: visible;
    }

    /* Drawer close button style */
    .menu-drawer__close-button {
      font-size: 1.4rem;
      font-weight: bold;
      border: none;
      background: none;
      cursor: pointer;
      margin-bottom: 1rem;
    }
  }
</style>

<script src="{{ 'cart-notification.js' | asset_url }}" defer="defer"></script>

{%- liquid
  for block in section.blocks
    if block.type == '@app'
      assign has_app_block = true
    endif
  endfor
-%}

{% liquid
  assign header_tag = 'div'
  if section.settings.sticky_header_type != 'none'
    assign header_tag = 'sticky-header'
  endif
%}

<{{ header_tag }}
  {% if header_tag == 'sticky-header' %}
    data-sticky-type="{{ section.settings.sticky_header_type }}"
  {% endif %}
  class="header-wrapper color-{{ section.settings.color_scheme }} gradient{% if section.settings.show_line_separator %} header-wrapper--border-bottom{% endif %}"
>
  <header class="header header--{{ section.settings.logo_position }} header--mobile-{{ section.settings.mobile_logo_position }} page-width{% if section.settings.menu_type_desktop == 'drawer' %} drawer-menu{% endif %}{% if section.settings.menu != blank %} header--has-menu{% endif %}{% if has_app_block %} header--has-app{% endif %}{% if shop.customer_accounts_enabled %} header--has-account{% endif %}">
    
    {%- if section.settings.menu != blank -%}
      {% render 'header-drawer' %}
    {%- endif -%}

    <!-- Logo -->
    <div class="header__heading">
      <a href="{{ routes.root_url }}" class="header__heading-link link link--text focus-inset">
        {% if settings.logo != blank %}
          <div class="header__heading-logo-wrapper">
            {{ settings.logo | image_url: width: 300 | image_tag: class: 'header__heading-logo', alt: shop.name }}
          </div>
        {% else %}
          <span class="h2">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>

    <!-- Icons -->
    <div class="header__icons">
      {% render 'header-search', input_id: 'Search-In-Modal' %}
      {% if shop.customer_accounts_enabled %}
        <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" class="header__icon header__icon--account">
          <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
        </a>
      {% endif %}
      <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart" id="cart-icon-bubble">
        <span class="svg-wrapper">
          {% if cart == empty %}
            {{ 'icon-cart-empty.svg' | inline_asset_content }}
          {% else %}
            {{ 'icon-cart.svg' | inline_asset_content }}
          {% endif %}
        </span>
        {% if cart != empty %}
          <div class="cart-count-bubble"><span>{{ cart.item_count }}</span></div>
        {% endif %}
      </a>
    </div>
  </header>
</{{ header_tag }}>


{% schema %}
{
  "name": "Advanced Header",
  "class": "section-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "select",
      "id": "sticky_header_type",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "on-scroll-up", "label": "On Scroll Up" },
        { "value": "always", "label": "Always Sticky" },
        { "value": "reduce-logo-size", "label": "Shrink on Scroll" }
      ],
      "default": "on-scroll-up",
      "label": "Sticky header type"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "default": "scheme-1",
      "label": "Color scheme"
    }
  ]
}
{% endschema %}
